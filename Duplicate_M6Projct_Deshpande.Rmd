---
title: ''
author: "Nikhil Deshpande"
date: "`r Sys.Date()`"
output: html_document
---

<P>
<BR>

<Center> 
  
  <B> <Font size = 4, color = "green"> M6 Project Report <BR> </Font>
     <BR>College of Professional Studies, Northeastern University 
     <BR> ALY 6010: Probability Theory and Introductory Statistics
     <BR>Nikhil Deshpande
     <BR>Dr. Diana Carolina Chiluiza, PhD <BR> </B>

</Center>

```{r Libraries and Dataset, echo=FALSE, message=FALSE, warning=FALSE}
rm(list=ls())

#Library######
library(readxl) 
library(tidyverse) 
library(dplyr) 
library(DT) 
library(RColorBrewer) 
library(rio) 
library(dbplyr) 
library(psych) 
library(FSA) 
library(knitr)
library(RColorBrewer)
library(plotrix)
library(kableExtra)
library(ISLR)
library(data.table)
library(magrittr)
library(ggplot2)
library(summarytools)
library(hrbrthemes)
library(cowplot)

#dataset used######

M6_Task3 <- read_excel("Datasets/M6_Task3.xlsx")

```
<BR>

<Center> 
  
  <B> <Font size = 4, color = "green"> Correlation and Regression </B> <BR> </Font>

</Center>
<BR>
<P><B>Introduction </B><BR>
<P>

1.Start with a little bit of history about correlation and linear regression, and the difference between correlation and determination coefficients
<P>Correlation is first used to understand the sizes difference between offspring and parent sweat pea seeds by Francis Galton. He further extended his study by ranking the height of fathers and sons. The result of this wasn't different than his earlier study. In latter he found that children are showing minimal or no variability and fewer extremes compared to their parents. What an amazing way of looking at the daily aspects our lives! Galton called this situation "reversion" and that is how we get the correlation symbol $r$.<BR>
<P>Karl Pearson,a friend of Galton's, coined the phrase "standard deviation" in 1893. In 1895, he released a paper in which he developed the present correlation coefficient formula and test statistic. Pearson's son, Egon, pioneered the concept of hypothesis testing in the 1920s, and his study led to the current definitions of the null and alternative hypotheses.<BR>
<P>Thus we can conclude that correlation determines the strength of relationship between two or more variables. It is also known as bivariate statistics. This relationship would be described as strong or weak relationship. A strong relationship would be when one variable has a influence on the other variable. If I do not write an informative report, Dr. Dee would be deducting my points. Writing an informative report influence grades. This relationship would be a strong positive relationship. On the other hand, strong negative relationship would be as number of errors increases, points for the task goes down. This relationship coefficient would always be between -1 and +1. <BR>
<P>Furthermore, coefficient of determination is the degree to which one variable is accountable for other variable's variation. It is denoted by $r^2$. The correlation coefficient of number of cigarettes per day and number of years they lived is highly positive. Assume the coefficient is -0.85. This can be summarized, higher the number of cigarettes per day, lower the number of years they lived. The determination of coefficient would be $-0.85^2$ that is 0.72. This means 72% number of years smokers life is affected by number of cigarettes they smoked per day. <BR>
<center> Correlation of coefficient $r=\frac{n*((\sum X,Y)-(\sum (X) * \sum (Y)))}{\sqrt{(n* \sum (X^2)- \sum (X)^2)* (n* \sum (Y^2)- \sum (Y)^2))}}$ <BR>
<P> Coefficient of Determination = $r^2$ 
</center>


2.Using your own words, inform your audience what do you understand about simple regression and multiple regression analysis. Talk about their importance and provide practical applications on the industry of your interest
<P> In the above examples, we have seen various simple regressions. Informative report and score, number of cigarettes per day and number of years they lived, and errors to points relationship. All these examples have one respondent and another explanatory.<BR>
The simple regression analysis studies the relationship between single dependent and single independent variable. Number of cigarettes per day and number of years they lived has single independent and single dependent variable which have the 85% influence on number of years smokers live and 15% unexplained. What if I want to study effect of alcohol as well along with  cigarettes? Rather than studying separate regression analysis on number of cigarettes and number of years they live and number of alcohol consumption in ml/day and number of years they live, we can study the multiple regression analysis. In this case, alcohol consumption ml/day and number of cigarettes per day would be independent variables and number of years they live dependent. <BR>
Multiple correlation coefficient is denoted by $R$ and Multiple correlation determination is denoted by $R^2$. <BR>
<P>I handled Sales and Marketing departments throughout my career and it’s very common in chalking Marketing strategies to understand the cost-efficiency and its contribution in revenue generation. If I may speak in terms of correlation, the revenue generation is dependent variable and marketing spending is independent variable. When I am doing aggressive marketing and trying every other means of marketing, I would see the increase in the sales leads and revenue generation grows ultimately. Scatter plots are used to show the correlation between two or more numeric variables.<BR>
<P>Now that we understood correlation between two variables, there could be a scenario where we need to estimate the effect of the two or more dependent variables on the dependent variable. It’s similar to what I explained in the first section, but if you dug deep, you would understand there be various marketing activities which would affect the revenue generation. In a nutshell, there are multiple marketing activities which would help to increase the revenue. 
Marketing activities will have influence on the Sales. Before I start spending on the marketing activities, I would be interested in understanding the influence of TTL, BTL and ATL strategies. For the simplicity, ATL (Broadcast) is traditional marketing channels such as TV advertisements, flyers distributions, and radio advertisement. BTL (niche) is weekly, monthly mails received, email marketing, and event sponsorships and TTL is online marketing or in-store promotions. 
I would be distributing the budget depending on the effectiveness of the activity. That means, I need to predict which activity would be effective and how much I need to spend. This prediction would be achieved by Regression. 
<center> Regression line formula $y’ = a + b_1x_1 + b_2x_2 + b_3x_3$</center><BR>


3.Explain the application of hypothesis testing in the context of regression analysis. Again, use a practical application example.
In one of the simple regression analysis, we understood number of cigarettes smoked per day and number of years they lived has a strong negative relationship. We calculated -0.85 coefficient correlation which supports the relationship. Suppose we want to claim that if you smoke 15 cigarettes per day for 10 years, your lifespan would be reduced by 2 years. That doesn't mean if anyone who is smoking more than 15 cigarettes per day for more than 5 years would be not be living long. This study would provide a reference to determine effect of heavy smoking on lifespan. <BR>
This relationship testing would be possible with hypothesis where, <center> $H_0:\rho = 0$ and $H_a:\rho \ne 0$ </center> 
<P>t test would be used to test correlation coefficient of the null hypothesis,
<center> $t = \frac{r}{\sqrt{\frac{1-r^2}{N-2}}}$ <BR>
where, $N$ = number of pairs of scores <BR> </center>
4.Explain the importance of this final project to demonstrate all the analytical skills you gained during the class.
<BR>
<P>The final project introduced to new tools for descriptive statistics. DescTools::desc() , and summary tool::descr() and pysch::describe(). The DescTools has recently been added to perform all the descriptive statistical operations including charts under single command. On the other hand, describe() is oftenly used in psychological studied to get most frequently asked statistical values such as mean, mode, median, min, max, range, and skew. Psych::describe() provides a data frame by default so that the output would readily be used for further statistical tests. Summarytools::descr() is used to calculate statistical values of Numeric data only. These three different tools are very powerful to gain insights on the dataset at a glance. <BR>
<P>Furthermore, understanding simple and multiple correlation and regression to calculate the predicted values would be very crucial in forecasting and decision making. Correlation and Hypothesis testing lead back to central limit theorem and calculating and level of significance. These statistical tests are critical for determining, analyzing, and predicting values to aid in decision making.<BR>
<P>Moreover, understanding the data is crucial before planning study plan. When you know your data, preparing study plan and statistical tests would be beneficial. We always prepare study plan and statistical tests depending on the data. Also, utilizing correct tools is equally important and understanding which charts are used depending upon variable would help in data visualization.<BR>
<P>In a nutshell, it is important to familiarize yourself with the data, use appropriate statistical tools and tests to make sound decisions. 

5.Discuss of all the advantages of using R for data analysis. 
<BR>
<P>Unlike other programming languages, R would not require compiler and interpreter to run the code. As it is heavily used to statistical calculations, performing multiple calculations using vector makes it easy and data visualization is one of the advantages of R. Furthermore, R supports data visualization, data interface, and statistical tests make it data science language. Descriptive and inferential statistics makes R a versatile statistical analysis platform for researchers.


<center>
    <B>
    <font size=4, color="A11515">Task 2.1: Descriptive statistics of the data set MPG</font>
    </B>
</center>


```{r Task 2.1, message=FALSE,echo=FALSE, warning=FALSE}
data(mpg)

descr(mpg) %>%
   kable(caption = "<center> Descriptive Statistic of MPG dataset using descr()</center>",
        align = "c",
        digits = 2) %>%
   kable_styling(bootstrap_options = c("hover",
                                        "bordered"),
                font_size = 11) %>%
   scroll_box(width = "100%", height = "100%") %>%
  footnote(general = "Table a",
           general_title = "Task 2.1: ")

describe(mpg) %>%
  kable(caption = "<center> Descriptive Statistic of MPG dataset using describe()</center>",
        align = "c",
        digits = 2) %>%
   kable_styling(bootstrap_options = c("hover",
                                        "bordered"),
                font_size = 11) %>%
   scroll_box(width = "100%", height = "100%") %>%
  footnote(general = "Table b",
           general_title = "Task 2.1: ")

```


<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>
Before starting a study, it's crucial to understand your data in statistics. Once you get the facts, you must take further procedures to reach a conclusion that will aid in decision making. This would be possible only if you know the data, appropriate statistical test.<BR>
MPG dataset is utilized in Table a, and descr() returns crucial descriptive statistical numbers and variable names. The fact that this table will only yield numerical variables should be noted.<BR>
<P>Moreover, Table b, provides descriptive statistics of MPG dataset. Many summary statistics are available in R; this function offers the ones generally relevant for scale design and component analysis in traditional psychometrics. Range is particularly effective for checking for coding problems during the initial run through a data collection (Rdocumentation, n.d.).<BR>
In describe(), descriptive statistics would be returned only for numeric variables and for logical or categorical variables are converted to numeric for the sake of calculation and are denoted by $*$. In table b, Manufacturer, Model, Transmission, Fuel, Vehicle Class, and Type of Drive train are denoted by $*$.<BR>
Table a provides descriptive statistics of numerical variables only and Table b provides descriptive statistics of numeric as well as logical or categorical variables by converting them and such variables are denoted by $*$ in the table b.<BR>
<P>
<center>
    <B>
    <font size=4, color="A11515">Task 2.2: Table with statistics.</font>
    </B>
</center>

```{r Task 2.2, echo=FALSE,message=FALSE, warning=FALSE}

# Using MPG data set, I would be observing the relationship between
#displacement and cylinders 
#code reference (Chiluiza, 2022)

cctocyl = mpg %>%  
  group_by(EngineCyl = cyl) %>%
  summarise(Mean = mean(displ), 
            SD = sd(displ),
            Minimum = min(displ),
            Maximum = max(displ))
 
cctocyl %>%
  kable(align = "c",
        caption = "<center>Engine Cylinders to Displacement</center>",
        format = "html",
        digits = 2,
        table.attr = "style='width:60%;'")%>%
  kable_classic_2(bootstrap_options=c("hover","bordered","condensed"),
              position = "center",
              font_size = 12) %>%
  add_header_above(c(" " = 1,"Engine Displacement (CC)" = 4))
 

```

<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>In this task we would be observing variables Displacement and Cylinder in a table format. The descriptive statistics of variable displacement are grouped by variable cylinder. Mean, Standard Deviation (SD), lower, and higher observations are presented in the table. These calculations are grouped by cylinder variable. Meaning, appropriate to number of cylinders, we can see Mean, SD, min, and max of each cylinder type. 


<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 2.3: Correlation and Determination</font>
    </B>
</center>

```{r Task 2.3, echo=FALSE,message=FALSE, warning=FALSE}

#Correlation coefficient and determination calculation#####

##calculating required variables######
tas2_3N = nrow(mpg)

task2_3data = data.frame(Cyclinder_X = mpg$cyl,
                         Displacement_Y = mpg$displ)

task2_3data %<>% mutate(XY = (task2_3data$Cyclinder_X)*(task2_3data$Displacement_Y),
                        X_Square = task2_3data$Cyclinder_X ^ 2,
                        Y_Square = task2_3data$Displacement_Y ^ 2)

sumX = sum(task2_3data$Cyclinder_X)
sumY = sum(task2_3data$Displacement_Y)
sumXY = sum(task2_3data$XY)
sumX_Square = sum(task2_3data$X_Square)
sumY_Square = sum(task2_3data$Y_Square)

task2_3data[nrow(task2_3data) + 1,] <- c(sumX,sumY,sumXY,sumX_Square,sumY_Square)



kable(tail(task2_3data,16),
      caption = "<center>Task 2.3 Correlation and Determination</center>",
      align = "c") %>%
  kable_styling(bootstrap_options = c("bordered",
                                      "responsive",
                                      "hover"),
                font_size = 11) %>%
  pack_rows("Sum of Variables", 16, 16) %>%
 scroll_box(width = "100%", height = "100%") %>%
   footnote(general = "Table a",
           general_title = "Task 2.3: ")

##Calculation######

Numerator = ((tas2_3N * (sumXY)) - ((sumX)*(sumY)))
Denominator = sqrt(((tas2_3N * (sumX_Square))-((sumX)^2))*((tas2_3N*(sumY_Square))-((sumY)^2)))


Linear_Correlation_Coefficient = Numerator / Denominator

coefficients_of_determination = ((Linear_Correlation_Coefficient) ^ 2)

##Information representation######

corr_coe_det = data.frame(Coef = Linear_Correlation_Coefficient,
                          deter = coefficients_of_determination)

kable(round(corr_coe_det,3),
      caption = "<center>Task 2.3 Correlation and Determination</center>",
      align = "c",
      col.names = c("Linear Correlation Coefficient",
                    "Linear Correlation Determinant")) %>%
  kable_styling(bootstrap_options = c("bordered",
                                      "responsive",
                                      "hover"),
                font_size = 11) %>%
 scroll_box(width = "100%", height = "100%") %>%
   footnote(general = "Table b, ",
           general_title = "Task 2.3: ")

```


<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>In the introduction section, we understood correlation coefficient and determination coefficient. In this task, we would be calculating coefficient of correlation of Displacement to Cylinder. Since number of cylinder would be used to determine cubic capacity of engine, Cylinder would be independent variable and Displacement, a dependent variable.<BR>
Correlation coefficient is calculated using the Pearson's coefficient formula: 
<center> 
$r=\frac{n*((\sum X,Y)-(\sum (X) * \sum (Y)))}{\sqrt{(n* \sum (X^2)- \sum (X)^2)* (n* \sum (Y^2)- \sum (Y)^2))}}$
</center><BR>
In table a, required variables' values are presented. The final table would be similar to this, except table b is used to show last few observations of the variables Cylinder and Displacement. The final row shows the sum of individual column.<BR>
Table b shows the correlation coefficient $r = 0.930$ and coefficient of determination $r^2 = (0.930 ^2)$ that would be $r^2 = 0.865$. From coefficient of correlation we can determine the it's a strong positive relationship and determination coefficient shows 86.5% displacement is influenced by cylinder and 13.5% by others. 



<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 2.4: Learn DescTools Library</font>
    </B>
</center>
```{r Task 2.4, echo=FALSE,message=FALSE, warning=FALSE}
#Learn DescTools library#####

DescTools::Desc(mpg$cty)
DescTools::Desc(mpg$fl)

```


<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center>
<BR>
<P>DescTools package includes resources for basic statistics as well as useful frameworks for convenient data description. Data analysis tools that use solid methodologies. This contains simulation approaches as well as multimodal statistics (Signorell, 2022).
<P>Creating graphical outlines, generating descriptive statistics, and summarizing the findings are the initial descriptive activities in study. The unification of diverse ways to calculating confidence intervals received special consideration.
Furthermore, the objective for putting everything here, was essentially to have them grouped in ONE rather than several packages, and to give a uniform and consistent functionality far as function and arguments names, NA handling, recycling rules etc. are interested (Signorell, 2022).
<BR>
<P>Desc() of course is Descriptive. As shown in the R output of the 'cty' variable, the length, number(n), NAs, and unique are some of the descriptive data analysis that the researcher should be aware of before conducting the study. The difference between length and n would be have been observed if NA values could have been present in the dataset. Since there are no NAs, the length and n is same.<BR>
Moreover, mean of the 'cty' variable is 16.86 and for confidence level (CL) 95% lower limit is 16.31 and upper limit is 17.41 with margin of error 1.1. The next line tells us about the quantiles. Assuming the city mileage is sorted ascending, the first quantile that is 5 percentile mileage level, 10 percentile, 25 percentile: first quartile, median, 75 percentile: third quartile, 90 and 95 percentile level would be observed. The IQR that is the distance between third and first quartile, which is 5. These values and observations could be verified in the boxplot and distribution plot presented in the chart section. The 0 skeweness would be a perfect symmetric. It's basically a degree to which the distribution is asymmetric. And the kurtosis is basically whether the curve is flatter or taller than the normal curve and have perfect value of 0.<BR>
<P>To summarize, the curve is close to perfect symmetric as skew is positive and little distanced from 0 and Kurtosis is little more than 1. The same could be observed in the density graph for 'cty.' The lowest and highest values in 234 observations, would help to understand the whiskers and outliers in boxplot.<BR>
<P>Moving forward, the we could observe useful charts and not statistical summary. The first chart is frequency chart that shows the relative frequency at the various observation levels. The chart shows both histo and a smooth line over the histogram. The boxplot shows the whiskers, box, and outliers. The size of the box is equal of the size of the IQR and the median for the distribution. The third plot is sigmoid cumulative frequency curve which shows the cumulative frequency of the number of observations. These curve trends would be helpful to understand whether or not the curve is asymmetric, whether it is skewed postive or negative, and how that asymmetry is expressed by the boxplot (Carlberg, 2020).<BR>
<P>The another variable I choose to observe is fuel type. The fuel types in the dataset are of five types. The fuel codes R, P, E, D, and C which indicates Electric (E), Gasoline that is Petrol (P and R), Diesel (D), Electric Plus (C), and Propane (P) (Fuel types, n.d.; ACRISS, n.d.). The unique tells us the unique values that is the class of fuel, level and duplicate values as it's fuel type. The level is the each type of fuel that is R, P, E, D, and C. The frequency is the count of that particular level, cumulative frequency, percentage, and cumulative percentage is provided.<BR>
<P>The chart section is the Pareto chart with vertical X-axis and ordered in descending order. R and P which are petrol fuel types are most famous fuel type with 168 and 52 observations respectively and C is just 1, which is the least famous as it's an electrical vehicle with distance $\ge$ 250mi/400km. 

<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 2.5: Linear regression</font>
    </B>
</center>


```{r Task 2.5, echo=FALSE,message=FALSE, warning=FALSE}
#linear regression#####

correlationdisplcyl = cor(mpg$cyl,mpg$displ)

linearRegcyldisp = lm(mpg$displ ~ mpg$cyl)
linearRegcyldisp

summlinreg = summary(linearRegcyldisp)

inter_a = as.numeric(summlinreg$coefficients[1])

slope_b = as.numeric(summlinreg$coefficients[2])


```


<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>In this task, Linear regression is calculated. The scatter plot is used to demonstrate the nature of the relationship between independent and dependent variable. Regression Line Equation would be determined by following formula:
<center>
$y' = a +bx$ where $a$ is the $y'$ intercept and $b$ is slope of the line (Bluman, 2014).</center><BR>
Summary() is used to store the summary of linear regression. This would help the researcher in understanding the statistical test values of displacement and cylinder regression. The intercept and slope values produced would be applied in subsequent tasks in this project.<BR>





<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 2.6: Scatter Plot</font>
    </B>
</center>


```{r Task 2.6, echo=FALSE,message=FALSE, warning=FALSE}
#Scatter plot######


ggplot(data = mpg, aes(x = cyl, y = displ)) + 
  geom_point(alpha = 0.5, 
             pch = 24) +
  geom_smooth(method = "lm", se = FALSE,
              color = "#99004C",
              lty=1,
              lwd=1)+
  labs(title = "Engine Cylinders to Displacement correlation",
       x = "Engine Cylinders",
       y = "Engine Displacement * 1000 (CC)")+
  theme(plot.title = element_text(hjust = 0.5))+
 geom_text(x=4.5, y=6.5, label=paste("Correlation:", round(Linear_Correlation_Coefficient,3)),
           color="forestgreen")+
  geom_text(x=4.5, y=5.8, label=paste("y' = ",round(inter_a,3) , "+",round(slope_b,3)  ,"x"),
            color="forestgreen")+
  geom_hline(yintercept = mean(mpg$displ),
              color = "Forestgreen",
              lty = 4,
              lwd = 1)+
  geom_hline(yintercept = median(mpg$displ),
              color = "darkgoldenrod1",
              lty = 6,
              lwd = 1)+
  geom_text(x=7, y=median(mpg$displ)-0.2, label=paste("Median:", median(mpg$displ)),
            color="gold4")+
  geom_text(x=5, y=mean(mpg$displ)+0.2, label=paste("Mean:", round(mean(mpg$displ),3)),
            color="darkslategray4")




```


<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>Scatter plot help us in visualizing the relationship between continuous variables. Correlation coefficient is 0.930 which mean the relationship is positive strong. The data on the chart seems like a straight line increasing from left to right. There is a positive correlation between the two variables because the slope of the line is positive.<BR>
Independent variable would be on the x-axis and dependent variable would be on the y-axis of the scatter plot. In the scatter plot, we would observe the regression line is stretched between start and end of the data and not much farther and line goes through the middle of the points.<BR>
Mean and Median lines of dependent variable displacement are plotted in the chart.<BR>
We can conclude that the higher the cylinder goes, the higher the displacement would be. 




<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 2.7:</font>
    </B>
</center>




```{r Task 2.7, echo=FALSE,message=FALSE, warning=FALSE}
#Predicted values and residuals

##Predicted Y' calculation#######

predicted_y = data.frame(Py = inter_a + ((slope_b) * (mpg$cyl)))

##Residual calculation#####
residual_y = data.frame(Ry = mpg$displ - predicted_y$Py)

#First 20 line of X, Y, Y', and Residual#####

task2_7table = data.frame(mpg$cyl,
                          mpg$displ,
                          round(predicted_y,3),
                          round(residual_y,3))

kable(head(task2_7table, 20),
      caption = "<center>Task 2.7 Predicted values and residuals</center>",
      align = "c",
      col.names = c("Cylinder_X",
                    "Displacement_Y",
                    "Predicted_Y",
                    "Residual")) %>%
  kable_styling(bootstrap_options = c("bordered",
                                      "responsive",
                                      "hover"),
                font_size = 11) %>%
 scroll_box(width = "100%", height = "100%") %>%
   footnote(general = "Table a, First 20 values",
           general_title = "Task 2.7: ")


```


<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>In task 2.5, we have calculated intercept and slop values using linear regression formula. These values would be used in this task to calculate predicted y and residual values.<BR>
Predicted y values would be calculated using:
<center>
$y' = a+bx$ where $a$ is intercept and $b$ is slope of the line. 
</center><BR>
With this formula we would be having predicted values for every independent (x) observation. Furthermore, residual would be calculated using:
<center> $residual = y-y'$ </center><BR>
The residuals are applied to find the best line that reflects the connection between the two variables (Bluman, 2014).<BR>
Table a shows the first 20 observations of Cylinder (X), Displacement (Y), Predicted Y ($Y'$), and Residual values. 






<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 2.8:</font>
    </B>
</center>

```{r Task 2.8, echo=FALSE,message=FALSE, warning=FALSE}

#Frequency and percentage table####


ncount = mpg %>% count(cyl)

ncount %<>% mutate(ncount,
                   CumFrequency = cumsum(n),
                         Percentage = round((100*(n/sum(n))),2),
                         CumPercentage = cumsum(Percentage))


kable(ncount,
      caption = "<center>Task 2.8 Frequency and percentage table</center>",
      align = "c",
      col.names = c("Number of Cylinders",
                    "Frequency of Cars",
                    "Cumulative Frequency",
                    "Percentage",
                    "Cumulative Percentage")) %>%
  kable_styling(bootstrap_options = c("bordered",
                                      "responsive",
                                      "hover"),
                font_size = 11) %>%
 scroll_box(width = "100%", height = "100%") %>%
   footnote(general = "Table a",
           general_title = "Task 2.8: ")


```

<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>Table a shows the cumulative frequency and cumulative percentage of cars based on cylinders. The first two columns of the table are Number of cylinders and Frequency Count respectively. Cumulative Frequency's and Cumulative Percentage's last observation shows 234 and 100% respectively that means the all the values in the dataset counted and there are no blanks or NAs. This is one of the effective ways to gain insights on dataset. 



<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 2.9:</font>
    </B>
</center>

```{r Task 2.9, echo=FALSE,message=FALSE, warning=FALSE}
#Graphs####

##Pie chart####

cols = c("green", "orange", "grey", "blue", "black", "yellow")

pie_labels <- paste0(ncount$Percentage, "%")

pie(ncount$n,
    labels= pie_labels,
    col = cols,
    density = 50,
    cex = 0.8,
    border="black",
    main = "Cars percentage by Cylinder")
legend("topright", 
       title = 'Number of Cylinder',
       legend = ncount$cyl, 
       border = "black",
       cex = 0.8,
   fill = cols)


##Bar grpah#####

ggplot(data = ncount, aes(x=cyl, y=n)) +
    geom_bar(stat="identity", fill="lightblue2", alpha=1, width=0.8) +
  ggtitle("Number of cars per cylinder")+
    ylab("Number of Cars") +
  xlab("Cylinder")+
    theme_bw()+
  theme(plot.title = element_text(hjust = 0.5))+
  geom_text(aes(label = n), vjust = 1.5)

```



<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>Based on the table a values of task 2.8, a bar chart and pie chart is prepared to understand the percentage of cars per cylinders and number of cars per cylinder in the dataset.<BR>
The pie chart illustrates that 4 and 6 cylinder cars are the most popular, while 5 cylinder cars are the least popular, accounting for only 1.71% of the dataset. Furthermore, the bar chart displays the number of cars per cylinder. The pie chart reveals that about 70% of the cars (160 out of 234 observations) had four or six cylinders. Along with 6 cylinders, 8 cylinder cars are well-known. 


<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 2.10:</font>
    </B>
</center>

```{r Task 2.10,echo=FALSE, message=FALSE, warning=FALSE}
#Prediction of Displacement#####

#Using the information prepared above, make some predictions for displacement if a car has 2 and 10 cylinders.

predict_2cy_disp = inter_a + ((slope_b) * 2)


predict_10cy_disp = inter_a + ((slope_b) * 10)



```

<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>In this task, we would forecast the engine's "cc" displacement. The letter CC stands for cubic centimeter. If an engine has a displacement of 2000cc and is a four-cylinder engine, it has four 500cc cylinders that pump air and fuel into the engine to create horsepower. If this engine runs at 3,000rpm, each piston in the engine may burn 500cc of gasoline and air 3,000 times per minute. The greater the amount of air and fuel that an engine can burn, the more power it normally generates (Haining, 2017). <BR>
Usually 2 cylinder engines are manufactured for small hatchback cars which are more fuel efficient as they would not be more than 1000cc. On the other hand, 4, 6,8,and 10 cylinder engines are used in Sedan, Pickup trucks, SUVs, and sports performance cars. 6,8,and 10 cylinder cars are more famous for generating great amount of power which of course have lesser fuel efficiency.<BR>
Automobile manufactures usually perform regression analysis to understand power to displacement, cylinder to displacement, weight to efficiency, or multiple regression analysis to achieve the balance of displacement, performance, efficiency, and weight. Sometimes 4 cylinder engines with 1600cc gets turbo boost to bridge the power to performance gap.<BR>
The predicted displacement for 2 cylinder engine is 0.5716235 which would be rounded up to 3 decimal points. The engine would be having 600cc engine on paper but in reality it could be 572 or more but less than 600cc.<BR>
Moreover, predicted 10 cylinder engine displacement is 6.53769 which would be 6500cc engine. In reality this could be reduced as well depending upon manufacturer's capability and even with as less as 5200 with variety of performance enhancements, this engine would be generating more power and increased efficiency. But for the task we would stick to predicted 6538cc displacement for 10 cylinder engine.

<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 3.1:</font>
    </B>
</center>


```{r Task 3.1,echo=FALSE, message=FALSE, warning=FALSE}
#The formula of your multiple regression model#####

##MRM = a +b1x1+b2x2

##The correlation between age and systolic blood pressure 

Task3_1 = data.frame(M6_Task3)

t3n = nrow(Task3_1) #total data groups
t3k = 2 #number of independent variables

corageandbp = cor(Task3_1$Age,Task3_1$SystolicBP) #ryx1
corweightandbp = cor(Task3_1$Weight,Task3_1$SystolicBP) #ryx2
corageandweight = cor(Task3_1$Age,Task3_1$Weight) #rx1x2

##determination coefficients between age with systolic blood pressure.

detcoeffageandbp = (corageandbp ^ 2)
detcoeffweightandbp = (corweightandbp ^ 2)

##Multiple regression###

multipleregression <- lm(SystolicBP ~ Age + Weight , data=Task3_1)
multipleregression
summultipleregression = summary(multipleregression) 

t3_inter_a = as.numeric(multipleregression$coefficients[1])
t3_age_slope_b1 = as.numeric(multipleregression$coefficients[2])
t3_weight_slope_b2 = as.numeric(multipleregression$coefficients[3])

#y' = t3_inter_a + t3_age_slope_b1*x1 + t3_weight_slope_b2*x2

##Multiple correlation coefficient####

MCCNum = (((corageandbp ^ 2)+(corweightandbp ^ 2)) - ((2*corageandbp)*(corweightandbp)*(corageandweight)))

MCCDen = (1-(corageandweight ^ 2))


R = sqrt(MCCNum/MCCDen)

###coefficient of multiple determination#####

R_sq = (R ^ 2)

error = 1 - R_sq

##Information representation sub task 1 to 3######

t3table = cbind(Task3_1$Age,
                Task3_1$Weight,
                Task3_1$SystolicBP,
                round(corageandbp,2),
                round(corweightandbp,2),
                round(detcoeffageandbp,2),
                round(detcoeffweightandbp,2),
                round(R,2),
                round(R_sq,2))

  
colnames(t3table) <- c("Patient Age(X1)",
            "Patient Weight(X2)",
            "Systolic BP(Y)",
            "Correlation Coefficient(r_yx1)",
            "Correlation Coefficient(r_yx2)",
            "Determinantion Coefficient(r^2_yx1)",
            "Determinantion Coefficient(r^2_yx2)",
            "Correlation of Multiple Coefficient(R)",
            "Coefficient of Multiple Determination(R^2)")


kable(t3table,
      caption = "<center>Task 3: Multiple Correlation Coefficeint and Determination</center>",
      align = "c")%>%
  kable_styling(bootstrap_options = c("bordered",
                                      "responsive",
                                      "hover"),
                font_size = 11) %>%
 scroll_box(width = "100%", height = "100%") %>%
   footnote(general = "Table a, Sub task 1 to 3",
           general_title = "Task 3.1: ")

```

<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>In this task, 15 patient's data is utilized to demonstrate multiple regression analysis. In multiple regression analysis, there are more than one independent variables and one dependent variable. Patient's age and weight are independent variables and systolic blood pressure would be dependent variable.<BR>
Table a, shows sub tasks 1 to 3. In this table we can seen correlation regression of two independent variables to one dependent has been calculated. Correlation coefficient of dependent and one independent variable is used $r_{yx1}$ and same repeated for second independent variable and dependent variable $r_{yx2}$. Also, coefficeint of correlation between two independent is calculated $r_{x1x2}$.Multiple linear regression formula is used to calculate interception, slop of $x_1$ and slope of $x_2$.<BR>
Multiple correlation coefficient R is calculated using following formula:
<center>
  $R = \frac{r_{yx1}^2 + r_{yx2}^2 - ((2*r_{yx1})* r_{yx2}*r_{x1x2})}{\sqrt{1-r_{x1x2}^2}}$
</center>
Coefficient of Multiple Determination is calculated as $R^2$.<BR>
Table a, sub task 1-3 shows these values. 
<BR>


```{r echo=FALSE,}
##F Test for Significance of R######

SigR = (R_sq/t3k) / ((error)/(t3n-t3k-1))


###Critical value####

dofN = t3n - t3k
dofD = t3n-t3k-1

CLt3 = 0.95
alpht31 = 1 - CLt3

fCV = qf(alpht31, dofN, dofD, lower.tail=FALSE)

#Can the systolic blood pressure be predicted using the other two variables?
#H0: p = 0 and Ha: p ≠ 0
Fhypores = ifelse(fCV < SigR, "Reject the null hypothesis: CV < F test",
       "Do not reject the null hypothesis: CV > F test")


##Information representation of sub task 4 to 6######

task3hypotable = rbind(round(SigR,3),
                       round(fCV,3),
                       Fhypores)

col_t3h <- c("Hypothesis test Result")   
row_t3h <- c("F test for Significance of R","Critical value (CV)","Hypothesis Result:")
  dimnames(task3hypotable) <- list(row_t3h,col_t3h)
  
kable(task3hypotable, 
        caption = "<center>f value test result</center>",
       align = "c") %>%
  kable_styling(bootstrap_options = c("bordered",
                                      "responsive",
                                      "hover"),
                font_size = 11) %>%
  scroll_box(width = "100%", height = "100%") %>%
   footnote(general = "Table b, Sub task 4 to 6",
           general_title = "Task 3.1: ")

```

<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>F test is used to test the significance of R (Bluman, 2014).<BR>
The hypothesis would be:
<center>
  $H0:\rho = 0$ &nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;&nbsp;&nbsp;&nbsp; $H0:\rho\ne 0$
</center><BR>
The formula for the F test is:
<center>
  $F = \frac{R^2/k}{(1-R^2)/(n-k-1)}$ <BR>
  where, $k$ = number of independent variables, $n$ = number of data groups, and Degrees of Freedom are $dofN=n-k$ and $dofD = n-k-1$
</center><BR>
As F test value is greater than critical level, we would reject the null hypothesis. This means that there is a significant relationship among patient's age, weight, and systolic BP. <BR>





```{r echo=FALSE,}

#What would be the expected systolic blood pressure for a person age = 30, weight = 148?

t3predict_y = t3_inter_a + (t3_age_slope_b1*30) + (t3_weight_slope_b2*148)


#What would be the expected systolic blood pressure for a person age = 75, weight = 196?

t3predict_y1 = t3_inter_a + (t3_age_slope_b1*75) + (t3_weight_slope_b2*196)


##Information representation of sub task 7 to 8######


task3_7 = rbind(t3predict_y,
                t3predict_y1)

col_t78 <- c("Systolic BP")   
row_t78 <- c("Age(x1) = 30, Weight(x2) = 148","Age(x1) = 75, Weight(x2) = 196")
  dimnames(task3_7) <- list(row_t78,col_t78)
  
kable(round(task3_7,0),
        caption = "<center>Predicted Systolic BP(y')</center>",
       align = "c") %>%
  kable_styling(bootstrap_options = c("bordered",
                                      "responsive",
                                      "hover"),
                font_size = 11) %>%
  scroll_box(width = "100%", height = "100%") %>%
   footnote(general = "Table c",
           general_title = "Task 3.7 & 3.8: ")



```


<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>In this task we would be predicting systolic BP of the patient where age($x_1$) and weight($x_2$) are already given. <BR>
<center>
  Multiple regression Equation is:<BR>
  $y’ = a + b_1x_1 + b_2x_2$
</center><BR>
Table C shows the predicted systolic BP for given patients.


<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 3.2: Scatter plots</font>
    </B>
</center>







```{r Task 3.2, echo=FALSE,message=FALSE, warning=FALSE}
# Scatter plots ######

sc1 <- ggplot(data = Task3_1, aes(x = Age, y = SystolicBP)) + 
  geom_point(alpha = 0.5, 
             pch = 24) +
  geom_smooth(method = "lm", se = FALSE,
              color = "#99004C",
              lty=1,
              lwd=1)+
  labs(title = "Age to Systolic BP correlation",
       x = "Patient Age",
       y = "Systolic BP")+
  theme(plot.title = element_text(hjust = 0.5))+
  xlim(40,80)+
 geom_text(x=49, y=165, label=paste("Correlation:", round(corageandbp,3)),
           color="forestgreen",size = 2)+
  geom_text(x=49, y=162, label=paste("y' = ",round(t3_inter_a,3) , "+",round(t3_age_slope_b1,3),"*x","+",round(t3_weight_slope_b2,3),"*x2"),
            color="forestgreen",size = 2)

sc2 <- ggplot(data = Task3_1, aes(x = Weight, y = SystolicBP)) + 
  geom_point(alpha = 0.5, 
             pch = 24) +
  geom_smooth(method = "lm", se = FALSE,
              color = "#99004C",
              lty=1,
              lwd=1)+
  labs(title = "Weight to Systolic BP correlation",
       x = "Patient Weight",
       y = "Systolic BP")+
  xlim(120,250)+
  theme(plot.title = element_text(hjust = 0.5))+
 geom_text(x=150, y=165, label=paste("Correlation:", round(corweightandbp,3)),
           color="forestgreen",size = 2)+
  geom_text(x=150, y=162, label=paste("y' = ",round(t3_inter_a,3) , "+",round(t3_age_slope_b1,3),"*x1","+",round(t3_weight_slope_b2,3),"*x2"),
            color="forestgreen",size = 2)

plot_grid(sc1, sc2, labels = "AUTO", label_size = 12)


```


<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>
Scatter plot help us in visualizing the relationship between continuous variables. Correlation coefficient of Age to Systolic BP is 0.925 and Weight to Systolic BP is 0.898. The data on the chart seems like a straight line increasing from left to right. There is a positive correlation between the two independent variables and a dependent variable because the slope of the line is positive.<BR>
Independent variable would be on the x-axis and dependent variable would be on the y-axis of the scatter plot. In the scatter plot, we would observe the regression line is stretched between start and end of the data and not much farther and line goes through the middle of the points.<BR>
We can conclude that the with increasing age and weight there systolic BP also goes up. As age increases it is common to have a high systolic BP because blood vessels would be hard with age, which effects blood pressure to go up. <BR> 



<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 3.3: Predicted values and residuals</font>
    </B>
</center>


```{r Task 3.3,echo=FALSE, message=FALSE, warning=FALSE}

#Predicted Value Calculation#####

#y' = t3_inter_a + t3_age_slope_b1*x1 + t3_weight_slope_b2*x2

t3_3predY = data.frame(PredY = t3_inter_a + (t3_age_slope_b1 * Task3_1$Age) + (t3_weight_slope_b2 * Task3_1$Weight))

#Residual Calculation#####

t3_3resi = data.frame(Resi = Task3_1$SystolicBP - t3_3predY$PredY)


#Information representation######

task3_3table = data.frame(Task3_1,
                          round(t3_3predY,0),
                          round(t3_3resi,0))

colnames(task3_3table)[5] = "Predicted Y'"
colnames(task3_3table)[6] = "Residual"

kable(task3_3table,
      caption = "<center>Task 3.3 Predicted values and residuals</center>",
      align = "c") %>%
  kable_styling(bootstrap_options = c("bordered",
                                      "responsive",
                                      "hover"),
                font_size = 11) %>%
 scroll_box(width = "100%", height = "100%") %>%
   footnote(general = "Table a",
           general_title = "Task 3.3: ")

```


<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>In table a, patient's predicted systolic BP and residual is shown. <BR>
We have calculated intercept and slope values in sub task 1 and 2. These values would be used in this task to calculate predicted y and residual values.<BR>
Predicted y values would be calculated using:
<center>
$y' = a+b_1x_1 +b_2x_2$ where $a$ is intercept and $b_1$ is slope of the line for independent variable 1 and $b_2$ is slope of the line for independent variable 2. 
</center><BR>
With this formula we would be having predicted values for every independent (x) observation. Furthermore, residual would be calculated using:
<center> $residual = y-y'$ </center><BR>
The residuals are applied to find the best line that reflects the connection between the two variables (Bluman, 2014).<BR>



<P><BR><center>
    <B>
    <font size=4, color="A11515">Task 3.4: Residual plots</font>
    </B>
</center>

```{r Task 3.4, echo=FALSE,message=FALSE, warning=FALSE}
#Residual Scatter Plot######
#Using the table from task 3.3, prepare and present two scatter plots to display (1) the residuals versus age values and (2) the residuals versus weight.

sc1 <- ggplot(data = task3_3table, aes(x = Age, y = Residual)) + 
  geom_point(alpha = 0.5, 
             pch = 19) +
  geom_smooth(method = "lm", se = FALSE,
              color = "#99004C",
              lty=1,
              lwd=1)+
  labs(title = "Residual to Age",
       x = "Patient Age",
       y = "Residual_Systolic BP")+
  theme(plot.title = element_text(hjust = 0.5))

sc2 <- ggplot(data = task3_3table, aes(x = Weight, y = Residual)) + 
  geom_point(alpha = 0.5, 
             pch = 19) +
  geom_smooth(method = "lm", se = FALSE,
              color = "#99004C",
              lty=1,
              lwd=1)+
  labs(title = "Residual to Weight",
       x = "Patient Weight",
       y = "Residual_Systolic BP")+
  theme(plot.title = element_text(hjust = 0.5))


plot_grid(sc1, sc2, labels = "AUTO", label_size = 12)


```

<P><BR><center>
    <B>
    <font size=4, color="A11515">Observations:</font>
    </B>
</center><BR>
<P>Residual value is a difference between regression line and data point vertically. Consider the lines to be averages; some data points will fit the line while others will not. The vertical axis of a residual plot displays the residual values, while the horizontal axis displays the independent variable. A residual plot is commonly used to identify regression issues (Glen, n.d.).<BR>
X-axis shows independent variable and Y-axis shows residuals. On a residual plot, y-values are positive means the prediction was low and if it's negative means the prediction was high, and 0 says the prediction was correct. <BR>
In our residual plots, there are some outliers but plots have almost half of the residual values on 0, which mean the prediction was correct.<BR><P>






<center>
    <B>
    <font size=4, color="A11515">Conclusion:</font>
    </B>
</center>
<BR>
<P>Task 2.1 and 2.4 would provide a statistical overview of the dataset. It is crucial for a researcher to understand the data first. How many variables are there, what type of variables are they, and their statistical operations. These tools would provide description statistical values which are often required in the study. Descr(), Describe(), and Desc() tools would provide required statistical operations performed on the dataset. It would definitely save the time and helps to better visualize the data.<BR>
Task 2 tests the single correlation coefficient and coefficient of determination to understand the influence of independent variable on the dependent variable. Correlation coefficient express the strength of the relationship whereas the coefficient of determination tells how strong is the influence. <BR>
Throughout the single correlation and regression testing, I have used various tools such as Linear regression line equation to predict dependent variables predicted value, scatter plot to visualize the established relationship between independent and dependent variable, and calculating residual values. Residuals are the vertical differences between the predicted values and regression line. <BR>
Furthermore, it is equally important to establish the meaning of the predicted values in terms of the correlation with independent variable. Throughout the task 3, I performed all the calculation I did in task 2, but this task is to understand multiple correlation. Often, various factors are considered and counted to make a sound decision. These factors would be multiple independent variables influencing dependent variable. In this task, scatter plot of residuals with independent variable would help the researcher to understand the outliers and the correlation to gain insights on predicted values.<BR>
Moreover, the significance test for multiple correlation coefficient would help to determine the significance of the relationship among independent variables and dependent variable.<BR>
Throughput this project I have utilized various statistical tests respective to the single or multiple correlation I would be testing. Occasionally researcher needs to test the significance of relationship between/among independent and dependent variables and having right information about statistical tests: t test or F test is important in hypothesis testing.<BR>
<P>This project provided me hands on experience with correlation and regression testing of one or more than one independent and dependent variables.<BR>



<P>
<center>
    <B>
    <font size=4, color="A11515">Reference:</font>
    </B>
</center><BR>
ACRISS. (n.d.). <I>Car classification code</I>. https://acriss.org/car-codes/
Chiluiza, D. (2022). Introduction to analytics using R, R Studio and R Markdown
Short manual series. Rpubs.com. https://rpubs.com/Dee_Chiluiza/home
Bluman, A. (2014). <I>Elementary statistics: A step by step approach</I>. McGraw-Hill Education.<BR>
Chiluiza, D. (2022). Introduction to analytics using R, R Studio and R Markdown
Short manual series. Rpubs.com. https://rpubs.com/Dee_Chiluiza/home 
Carlber, C. (2020). <I>R for excel users</I>[video]. LinkedIn. https://www.linkedin.com/learning/r-for-excel-users/welcome?autoplay=true&resume=false&u=74653650 <BR>
<I>Fuel types</I>. (n.d.). Fuelfreedom.  https://www.fuelfreedom.org/our-work/fuels-101/fuel-types/<BR>
Glen, s.(n.d.). 
<I>Residual plot: Definition and Examples</I>. Statisticshowto. https://www.statisticshowto.com/residual-plot/<BR>
Haining, C. (2017). <I>What do engine sizes actually mean?</I>. https://news.motability.co.uk/motoring/what-do-engine-sizes-actually-mean/<BR> 
Rdocumentaion. (n.d.). <I>Describe: Basic descriptive statistics useful for psychometrics</I>. https://www.rdocumentation.org/packages/psych/versions/2.2.9/topics/describe<BR>
Signorell, A. (2022). <I>Package DescTools</I>. CRAN. https://cran.r-project.org/web/packages/DescTools/DescTools.pdf <BR>




<center>
    <B>
    <font size=4, color="A11515">Appendix</font>
    </B>
</center>
<P>An R Markdown file and duplicate HTML report has been attached to this report. They are M6Project_Deshpande.Rmd and Duplicate_M6Project_Deshpande.html

<center>
    <B>
    <font size=4, color="A11515">Acknowledgement</font>
    </B>
</center>
<BR>
<P>This class was daunting for me because my previous course, ALY6010, had been one and a half years prior. I was concerned for the first two weeks since I was still processing what I had learned in earlier classes. During this class, my classmates and TA assisted me in understanding some of the little details I had overlooked previously. <BR> Prof. Dee, on the other hand, deserves special mention for explaining all statistical principles using real-life examples. <BR> I was fortunate to have Prof. Dee as my ALY6010 instructor. Thank you so much, Professor Dee! <BR>